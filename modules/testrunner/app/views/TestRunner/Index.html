<!DOCTYPE html>
<html>
	<head>
		<title>Revel Test Runner</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
		<link href="/@tests/public/css/bootstrap.css" type="text/css" rel="stylesheet"></link>
		<script src="/@tests/public/js/jquery-1.5.2.min.js" type="text/javascript"></script>
		<style>
		header { padding:20px 0; background-color:#ADD8E6 }
		.success td { background-color: #90EE90 !important;}
		.fail td { background-color: #FFB6C1 !important;}
		.tests td.name, .tests td.result { padding-top: 13px; }
		.message { font-weight: bold; }
		.details { background-color: #D3D3D3; border: 1px solid #808080;  }
		</style>
	</head>
	<body>
		<header>
			<div class="container">
				<table><tr><td>
					<h1>Test Runner</h1>
					<p class="lead">Run all of your application's tests from here.</p>
				</td><td style="padding-left:150px;">
					<button class="btn btn-large">Run All Tests</button>
				</td></tr></table>
			</div>
		</header>

		<div class="container">
			{{range .functionalTestSuites}}
				<p class="lead" style="margin-top:20px;">{{.Name}}</p>
				<table class="table table-striped tests" suite="{{.Name}}">
					{{range .Tests}}
						<tr>
							<td class="name">{{.Name}}</td>
							<td class="result">
								<span class="message"></span>
								<div class="details" style="display:none;"><div></td>
							<td><button test="{{.Name}}" class="btn">Run</button></td>
						</tr>
					{{end}}
				</table>
			{{end}}
		</div>

<script>
$("button[test]").click(function() {
	var suite = $(this).parents("table").attr("suite");
	var test = $(this).attr("test");
	var row = $(this).parents("tr");
	var resultCell = row.children(".result");
	$.getJSON("/@tests/"+suite+"/"+test, function(result) {
		row.attr("class", result.Success ? "success" : "fail");
		resultCell.children(".message").text(result.ErrorMessage);
		resultCell.children(".details").text(result.Stack);
	});
});
$("td.result").click(function() {
	$(this).children(".details").toggle();
});
</script>

	</body>
</html>
