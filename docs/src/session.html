---
layout: godoc
---

<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<h1>Session</h1>



	<pre>package revel

<span class="comment">// A signed cookie (and thus limited to 4kb in size).</span>
<span class="comment">// Restriction: Keys may not have a colon in them.</span>
type Session map[string]string

const (
    SESSION_ID_KEY = &#34;_ID&#34;
)

<span class="comment">// Return a UUID identifying this session.</span>
func (s Session) Id() string {
    if uuidStr, ok := s[SESSION_ID_KEY]; ok {
        return uuidStr
    }

    uuid, err := simpleuuid.NewTime(time.Now())
    if err != nil {
        panic(err) <span class="comment">// I don&#39;t think this can actually happen.</span>
    }
    s[SESSION_ID_KEY] = uuid.String()
    return s[SESSION_ID_KEY]
}

type SessionPlugin struct{ EmptyPlugin }

func (p SessionPlugin) BeforeRequest(c *Controller) {
    c.Session = restoreSession(c.Request.Request)
}

func (p SessionPlugin) AfterRequest(c *Controller) {
    <span class="comment">// Store the session (and sign it).</span>
    var sessionValue string
    for key, value := range c.Session {
        if strings.ContainsAny(key, &#34;:\x00&#34;) {
            panic(&#34;Session keys may not have colons or null bytes&#34;)
        }
        if strings.Contains(value, &#34;\x00&#34;) {
            panic(&#34;Session values may not have null bytes&#34;)
        }
        sessionValue += &#34;\x00&#34; + key + &#34;:&#34; + value + &#34;\x00&#34;
    }
    sessionData := url.QueryEscape(sessionValue)
    c.SetCookie(&amp;http.Cookie{
        Name:  CookiePrefix + &#34;_SESSION&#34;,
        Value: Sign(sessionData) + &#34;-&#34; + sessionData,
        Path:  &#34;/&#34;,
    })
}
</pre>





